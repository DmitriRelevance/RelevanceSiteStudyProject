@rendermode InteractiveServer
@inject NotificationService NotificationService
@inject IJSRuntime JSRuntime
@implements IDisposable

<div class="notification-bell" @onclick="TogglePanel">
    <span class="bell-icon">🔔</span>
    @if (NotificationService.UnreadCount > 0)
    {
        <span class="badge">@NotificationService.UnreadCount</span>
    }
</div>

@if (showPanel)
{
    <div id= "notificationPanel" class="notification-log" @ref="panelRef" hidden ="@(!showPanel)">
        @foreach (var note in NotificationService.Notifications.OrderByDescending(n => n.Timestamp))
        {
            <div class="notification-entry @(note.IsRead ? "read" : "unread")">
                <strong>@note.Type</strong>: @note.Message
                <span class="timestamp">@note.Timestamp.ToShortTimeString()</span>
            </div>
        }

        <button @onclick="MarkAllAsRead">Mark all as read</button>
    </div>
}